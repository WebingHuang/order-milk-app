(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/index"],{194:function(e,t,r){"use strict";(function(e){r(5);n(r(4));var t=n(r(195));function n(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=r,e(t.default)}).call(this,r(1)["createPage"])},195:function(e,t,r){"use strict";r.r(t);var n=r(196),o=r(198);for(var s in o)"default"!==s&&function(e){r.d(t,e,(function(){return o[e]}))}(s);r(200);var i,a=r(11),u=Object(a["default"])(o["default"],n["render"],n["staticRenderFns"],!1,null,null,null,!1,n["components"],i);u.options.__file="pages/order/index.vue",t["default"]=u.exports},196:function(e,t,r){"use strict";r.r(t);var n=r(197);r.d(t,"render",(function(){return n["render"]})),r.d(t,"staticRenderFns",(function(){return n["staticRenderFns"]})),r.d(t,"recyclableRender",(function(){return n["recyclableRender"]})),r.d(t,"components",(function(){return n["components"]}))},197:function(e,t,r){"use strict";var n;r.r(t),r.d(t,"render",(function(){return o})),r.d(t,"staticRenderFns",(function(){return i})),r.d(t,"recyclableRender",(function(){return s})),r.d(t,"components",(function(){return n}));try{n={uLoadmore:function(){return r.e("uview-ui/components/u-loadmore/u-loadmore").then(r.bind(null,601))}}}catch(a){if(-1===a.message.indexOf("Cannot find module")||-1===a.message.indexOf(".vue"))throw a;console.error(a.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var o=function(){var e=this,t=e.$createElement;e._self._c},s=!1,i=[];o._withStripped=!0},198:function(e,t,r){"use strict";r.r(t);var n=r(199),o=r.n(n);for(var s in n)"default"!==s&&function(e){r.d(t,e,(function(){return n[e]}))}(s);t["default"]=o.a},199:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(r(80));function o(e){return e&&e.__esModule?e:{default:e}}var s={0:["取消订单","待付款"],1:["申请退款","查看未送牛奶"],2:["申请退款","查看未送牛奶"],3:["去复购"],4:["退款中"],5:["已退款"]},i={data:function(){return{fixType:[1,5],list:[{name:"全部"},{name:"待付款"},{name:"未送完"},{name:"已送完"},{name:"退款"}],page:{status:"loadMore",pageNum:1,pageSize:10},current:"全部",Height:"",ordersList:[],orderStatus:""}},onLoad:function(t){var r=e.getStorageSync("current"),n=e.getStorageSync("orderStatus");r&&n&&(e.removeStorageSync("current"),e.removeStorageSync("orderStatus")),(t.current||t.orderStatus)&&(this.current=t.current,this.orderStatus=t.orderStatus),this.ordersList=[],this.getOrderList(),this.getAppHeight()},onHide:function(){e.setStorageSync("current",this.current),e.setStorageSync("orderStatus",this.orderStatus)},onShow:function(){var t=e.getStorageSync("current"),r=e.getStorageSync("orderStatus");t&&r&&(this.current=t,this.orderStatus=r,this.ordersList=[],this.getOrderList())},methods:{getOrderList:function(){var e=this,t=Object.assign({orderStatus:this.orderStatus},this.fixType.includes(this.orderStatus)?{type:1==this.orderStatus?1:2}:{});this.$u.api.findByOrders({pageRequest:{pageNum:this.page.pageNum,pageSize:this.page.pageSize},omsOrderVo:t}).then((function(t){t.records.forEach((function(t){e.ordersList.push(t),t.buts=e.getbuts(t.orderStatus)})),t.current==t.pages&&(e.page.status="noneMore")})).catch()},getbuts:function(e){switch(e){case"0":return s[e];case"1":return s[e];case"2":return s[e];case"3":return s[e];case"4":return s[e];case"5":return s[e];case"6":return s[e]}},handlerButt:n.default.debounce((function(e,t){switch(e){case"待付款":this.topaid(t);break;case"取消订单":this.cancelOrder(t);break;case"去复购":this.repurchase(t);break;case"查看未送牛奶":this.sendMilk(t);break;case"提醒发货":this.remindDelivery(t);break;case"确认收货":this.confirmReceipt(t);break;case"申请退款":this.tosales(t);break}}),1e3,{leading:!0,trailing:!1}),tosales:function(t){var r=["该订单为月付订单，不可申请退款","该订单为先送后付订单，不可申请退款","该订单为可退数量为0，不可申请退款"],n=-1;t.totalCanRefundNum<=0&&(n=2),3==t.payType?n=0:1==t.payType&&(n=1),n>-1?e.showModal({title:"提示",content:r[n],confirmColor:"black",showCancel:!1,confirmText:"确定",success:function(e){e.confirm&&console.log("没有操作")}}):e.navigateTo({url:"/pages/my/torefund?id="+t.id+"&orderSn="+t.orderSn+"&payAmount="+t.payAmount+"&omsOrderItemEntityList="+encodeURIComponent(JSON.stringify(t.omsOrderItemEntityList))+"&totalRefundAmount="+t.totalRefundAmount+"&totalCanRefundNum="+t.totalCanRefundNum})},handlerItem:function(t){"5"==t.orderStatus||"4"==t.orderStatus||"6"==t.orderStatus?e.navigateTo({url:"/pages/order/refundPage?list="+encodeURIComponent(JSON.stringify(t))}):e.navigateTo({url:"/pages/order/topaid?list="+encodeURIComponent(JSON.stringify(t))})},topaid:function(t){var r=[],n=[],o=[];t.omsOrderItemEntityList.map((function(e){r.push(e.spuId),n.push(e.skuId),o.push(e.skuQuantity)})),e.navigateTo({url:"/pages/order/confirmOrder?supId="+r.join(",")+"&skuId="+n.join(",")+"&num="+o.join(",")+"&orderSn="+t.orderSn+"&batchId="+t.batchId})},cancelOrder:function(t){var r=this;this.$u.api.updateStatus({orderSn:t.orderSn,orderStatus:"4",deliverySn:""}).then((function(t){e.showToast({title:"已取消订单"}),r.current="待付款",r.orderStatus="0",r.ordersList=[],r.getOrderList()})).catch()},repurchase:function(t){e.navigateTo({url:"/pages/commodity/info?id="+t.omsOrderItemEntityList[0].spuId})},sendMilk:function(t){console.log("未送牛奶",t),e.navigateTo({url:"/pages/order/unsentDetail"})},remindDelivery:function(){console.log("提醒发货")},confirmReceipt:function(t){var r=this,n=[];t.omsOrderItemEntityList.map((function(e){n.push(e.spuId)})),this.$u.api.confirmReceipt({orderSn:t.orderSn,spuId:n}).then((function(t){e.showToast({title:"确认收货"}),r.ordersList=[],r.current="全部",r.orderStatus="",r.getOrderList()})).catch()},checkLogistics:function(){console.log("查看物流")},change:function(e){switch(e.name){case"全部":this.current="全部";break;case"待付款":this.current="待付款";break;case"未送完":this.current="未送完";break;case"已送完":this.current="已送完";break;case"退款":this.current="退款";break}var t;t="待付款"===this.current?0:"未送完"===this.current?1:"已送完"===this.current?3:"退款"===this.current?5:"",this.orderStatus=t,this.ordersList=[],this.getOrderList()},handlerClick:function(e){switch(e.type){case"全部":this.current="全部";break;case"待付款":this.current="待付款";break;case"未送完":this.current="未送完";break;case"已送完":this.current="已送完";break}},onReachBottom:function(){"loadMore"===this.page.status&&(this.page.pageNum++,this.getOrderList())},getAppHeight:function(){this.Height=e.getSystemInfoSync().windowHeight+"px"}}};t.default=i}).call(this,r(1)["default"])},200:function(e,t,r){"use strict";r.r(t);var n=r(201),o=r.n(n);for(var s in n)"default"!==s&&function(e){r.d(t,e,(function(){return n[e]}))}(s);t["default"]=o.a},201:function(e,t,r){}},[[194,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/order/index.js.map